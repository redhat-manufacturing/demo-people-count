import{a,j as e,J as w,B as v,K as S,I as f,F as T,L as N,M as y,t as x,r as E,S as L}from"./index-1201fba5.js";import{A as b}from"./axios-aaa1c0c0.js";import{u as D}from"./useQuery.esm-508d0e52.js";const u=({label:c,register:r,watch:m,required:o,cls:i,type:l,state:t,errors:s,...h})=>{var p,n;return a("div",{className:"w-full",children:[e("div",{className:"mb-1",children:e("label",{htmlFor:t,className:"text-sm uppercase text-[#9ba8c4] font-medium px-1",children:c})}),a("div",{className:"w-full grid grid-cols-4 ",children:[e("input",{type:l,name:t,id:t,className:`w-full  col-span-3 range-bar
           font-medium   focus:outline-none   
          rounded-lg bg-[#18172a] focus:outline-indigo-500  shadow-xl overflow-hidden appearance-none ${i}`,...h,...r(t,{required:o})}),l==="range"?e("div",{className:"bg-[#18172a] rounded-lg shadow-xl text-gray-400   text-center  font-semibold py-3  ml-5",children:m(t)}):null]}),e("div",{className:"mb-4",children:(((p=s[t])==null?void 0:p.type)==="required"||s[t])&&e(w,{msz:((n=s[t])==null?void 0:n.message)||"Required"})})]})},_=({useCase:c,initialValues:r,setRefetch:m})=>{const{register:o,handleSubmit:i,reset:l,watch:t,formState:{errors:s,isSubmitting:h}}=v({defaultValues:{thresholdPerson:(r==null?void 0:r.DET_THRESH_PERSON)||0,thresholdLogo:(r==null?void 0:r.DET_THRESH_LOGO)||0,stopTime:r==null?void 0:r.END,startTime:r==null?void 0:r.START,saveVideo:r==null?void 0:r.SAVE_VIDEO},resolver:S(y)});return e("div",{className:" bg-core-widget shadow-lg p-10 mt-10 filter drop-shadow-lg  rounded-lg  max-w-xl  w-full",children:a("form",{className:"w-full space-y-3 font-medium ",onSubmit:i(async n=>{const d=new FormData;c!=="apparel-logo"?d.append("DET_THRESH",n.threshold):(d.append("DET_THRESH_PERSON",n.thresholdPerson),d.append("DET_THRESH_LOGO",n.thresholdLogo)),d.append("END",n.stopTime),d.append("START",n.startTime),d.append("SAVE_VIDEO",n.saveVideo);try{const{data:g}=await b.post("/update_env",d);m(new Date().getMilliseconds()),x.success(g.msg),l()}catch(g){x.error(g.message)}}),children:[a("div",{className:"space-y-3",children:[e(f,{label:"Start Pipeline",register:o,required:!0,cls:"",placeholder:"Start Time",type:"number",state:"startTime",errors:s,icon:e("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e(f,{label:"Stop Pipeline",register:o,required:!0,cls:"",placeholder:"Stop Time",type:"number",state:"stopTime",errors:s,icon:e("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})})}),c!=="apparel-logo"?e(u,{label:"Threshold",register:o,watch:t,required:!0,state:"thresholdPerson",errors:s,type:"range",min:"0",max:"1",step:"0.01"}):a(T,{children:[e(u,{label:"Threshold for Person detection",register:o,required:!0,state:"thresholdPerson",errors:s,type:"range",min:"0",watch:t,max:"1",step:"0.01"})," ",e(u,{label:"Threshold for Logo detection",register:o,required:!0,watch:t,state:"thresholdLogo",errors:s,type:"range",min:"0",max:"1",step:"0.01"})]}),e("div",{children:a("label",{htmlFor:"saveVideo",className:"text-sm font-semibold uppercase text-[#9ba8c4]  px-1 leading-none flex items-center  gap-4 py-3 ",children:[e("input",{type:"checkbox",placeholder:"saveVideo",id:"saveVideo",name:"saveVideo",className:" h-5 w-5 accent-[#4675af]",...o("saveVideo")}),"Save Video"]})})]}),a("div",{className:"flex gap-y-7    items-center flex-col",children:[e("button",{type:"submit",disabled:h,className:`${h?"bg-dark-bg  text-gray-400 hover:bg-[#18172a] cursor-not-allowed":"bg-indigo-500 hover:bg-indigo-700 focus:bg-indigo-700 text-white cursor-pointer"} font-semibold  uppercase leading-none   focus:outline-none rounded  py-4 px-10 mt-5  ease-in-out duration-300`,children:h?e(N,{name:"Please Wait..."}):e("div",{className:"font-bold",children:"Update"})}),a("p",{className:"text-center text-core-warning text-xs font-medium",children:["Updating the settings will ",e("strong",{className:"font-extrabold uppercase",children:"stop"})," the current process"]})]})]})})},H=()=>{const[c,r]=E.useState(new Date().getMilliseconds()),{data:m,error:o,isError:i,isLoading:l}=D(["settingsQueryData",c],async()=>(await b.get("/give_curr_settings")).data,{refetchOnWindowFocus:!1});return l?e(L,{}):i?e("div",{className:"min-h-screen flex items-center justify-center text-rose-500 text-sm",children:"An error has occured: "+o.message}):e("div",{className:" flex min-h-screen items-center justify-center",children:e(_,{useCase:"apparel-logo",initialValues:m||{startTime:"",stopTime:"",threshold:0,thresholdPerson:0,thresholdLogo:0,saveVideo:!1},setRefetch:r})})};export{H as Settings,H as default};
